# Trigger Policy

## 明示トリガー

- ユーザー入力に `$create-context` がある
- アクション: `create_context` を実行

## セッション復元トリガー

- コーディングセッション開始/再開時
- アクション: 先に `get_session_continuity` を実行
- continuity が不足する場合のみ `create_context` を実行

## 調査・計画トリガー（必須）

- ユーザー意図が調査 / 計画 / Web検索
- アクション: `get_session_continuity` を実行
- アクション: 外部情報収集の前に `create_context` を実行

## 自律トリガー（許可）

履歴再構成が必要な意図なら `create_context` を実行してよい。

- "今の状態を説明して"
- "なぜこの方針になった？"
- "最近変わった前提は？"
- "task:xxx / spec:xxx の背景は？"
- "PR #xxx の背景は？（PRがある場合）"
- "再開するので前回までを要約して"
- "このURLを渡した時の判断は？"
- "Issue #xxx と PR #yyy のつながりを教えて（GitHub運用時のみ）"

## 実行しない条件

- ローカル実装だけで回答できる質問
- 雑談
- 新しい履歴要求がない重複query

## 実行頻度

- 1つの意図につき1回実行。
- query範囲が変わった場合、または深掘り要求がある場合のみ再実行。
- 根拠が薄い場合は、明示アンカー付きqueryで1回だけ再試行。
